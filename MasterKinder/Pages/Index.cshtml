@page
@model MasterKinder.Pages.IndexModel
@{
    ViewData["Title"] = "Survey Responses";
}

<h2>Survey Responses</h2>

<form method="post" asp-page-handler="SelectQuestion">
    <div>
        <label for="questionSelect">Select Question:</label>
        <select id="questionSelect" name="SelectedQuestion" asp-for="SelectedQuestion" asp-items="@(new SelectList(Model.Questions, Model.SelectedQuestion))">
        </select>
    </div>
    <div>
        <label for="forskoleverksamhetSelect">Select Forskoleverksamhet:</label>
        <select id="forskoleverksamhetSelect" name="SelectedForskoleverksamhet" asp-for="SelectedForskoleverksamhet" asp-items="@(new SelectList(Model.Forskoleverksamheter, Model.SelectedForskoleverksamhet))">
        </select>
    </div>
    <button type="submit">Load Data</button>
</form>

@if (Model.ResponsePercentages != null && Model.ResponsePercentages.Any())
{
    <h3>Response Percentages for the Question</h3>
    @if (Model.ResponsePercentages.Sum(rp => rp.Value) != 100)
    {
        <p>Warning: The response percentages do not sum up to 100%</p>
    }
    <table>
        <thead>
            <tr>
                <th>Response</th>
                <th>Percentage</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var response in Model.ResponsePercentages)
            {
                <tr>
                    <td>@response.Key</td>
                    <td>@response.Value.ToString("F2") %</td>
                </tr>
            }
        </tbody>
    </table>
}

