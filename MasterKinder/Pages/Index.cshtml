@page
@model MasterKinder.Pages.IndexModel
@{
    ViewData["Title"] = "Survey Response Data";
}

<h1>@ViewData["Title"]</h1>

<form method="post">
    <label for="questionSelect">Select Question:</label>
    <select id="questionSelect" name="SelectedQuestion">
        @foreach (var question in Model.Questions)
        {
            var isSelected = question == Model.SelectedQuestion ? "selected" : "";
            <option value="@question" selected="@isSelected">@question</option>
        }
    </select>
    <button type="submit">Load Data</button>
</form>

<form method="post" asp-page-handler="DeleteRowsWithNumbersInFragetext">
    <button type="submit">Delete Rows with Numbers in Fragetext</button>
</form>

<h2>Response Percentages for the Question</h2>
@if (Model.ResponsePercentages != null && Model.ResponsePercentages.Count > 0)
{
    @if (Model.ResponsePercentages.Values.Sum() < 100)
    {
        <div>Warning: The response percentages do not sum up to 100%</div>
    }

    <table>
        <thead>
            <tr>
                <th>Response</th>
                <th>Percentage</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.ResponsePercentages)
            {
                <tr>
                    <td>@item.Key</td>
                    <td>@item.Value.ToString("F2") %</td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <div>No responses found for the question.</div>
}

<h3>Specific Response Percentage ('Vet ej')</h3>
<p>@Model.SpecificResponsePercentage.ToString("F2") %</p>

<h3>Overall Satisfaction Percentage ('Nöjd')</h3>
<p>@Model.OverallSatisfactionPercentage.ToString("F2") %</p>
